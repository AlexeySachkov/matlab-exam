# Безусловная одномерная и многомерная оптимизация

### Одномерная оптимизация

Функция f(x) одного аргумента х называется унимодальной на отрезке [a, b], если на нем найдется такая точка x0(точка минимума), что f(x) монотонно убывает при   a ≤ x ≤ x0  и монотонно возрастает при x0 ≤ x ≤ b.

Для минимизации унимодальной функции, заданной на отрезке Matlab предоставляет функцию fminbnd. Ее можно применять и для минимизации функций, не являющихся унимодальными. В этом случае будет найден локальный минимум. 

Простейший вариант вызова fminbnd имеет вид:

    x = fminbnd(f, a, b)
    
Здесь f — либо символьная строка, содержащая математическую запись выражения, либо указатель на функцию вида @fun, где fun — имя функции, например, имя mфайла. В первом случае именем независимой переменной может быть только x. 

То есть fminbnd(f, a, b) ищет такой х, который соответствует минимальному значению f.

**Пример:**

Возьмем функцию y = x^6 + 7x^4 −2x, x ∈ [−2,2].

Построим её график и найдем точку минимума:

  ezplot('x^6 + 7*x^4 - 2*x', -2, 2)
  
  fminbnd('x^6 + 7*x^4 - 2*x', -2, 2)

  ans =

      0.4100
      
Можно оформить целевую функцию в виде m-файла или разместить ее как подфункцию в другой m-файл:

function y = myfun(x)

y = x^6 + 7*x^4 − 2*x;

Теперь вызвать fminbnd можно так:

fminbnd(@myfun, −2, 2)

Функцию fminbnd можно вызывать с разным количеством входных и выходных аргументов:

    * x = fminbnd(f, a, b)
    * x = fminbnd(f, a, b, options)
    * x = fminbnd(f, a, b, options, P1, P2, ..., Pn)
    * [x, fval] = fminbnd(...)  - кроме найденной точки минимума x, возвращает также само значение f(x) в найденной точке x. 
    * [x, fval, exitﬂag] = fminbnd(...) - возвращает флаг окончания exitﬂag.
    * [x, fval, exitﬂag, output] = fminbnd(...) - возвращает структуру output, в которой
    
    output.algorithm — символьная строка, содержащая название используемого алгоритма, output.funcCount — количество вычислений значений целевой функции, output.iterations — общее число итераций. 

options — это структура с дополнительными параметрами (опциями).

Возможные опции: 

* Display: 

    * ’Oﬀ’ -  запрещает любые сообщения о ходе работы алгоритма; 
    * ’Iter’ - сообщает о ходе вычислений на каждой итерации;
    * ’Final’ - выдает информацию только по окончании работы;
    * ’Converge’ - выдает информацию, только в случае, если алгоритм не сошелся (по умолчанию). 
    
* FunValCheck:

    * ’On’ - выдает предупреждение вскяий раз, когда значение функции — комплексное число или NaN; 
    * ’Oﬀ’ - предупреждения не выдаются.
    
* MaxFunEvals -  задает максимальное количество вычислений значений целевой функции. 
* MaxIter - задает максимальное число итераций. 
* OutputFcn - определяет пользовательскую функцию, которую Matlab будет вызывать на каждой итерации. 
* TolX - допуск на ошибку в независимой переменной.

Определить поля структуры options можно с помощью функции optimset. Например,

    options = optimset(’Display’, ’Iter’, ’OutputFcn’, @OutputFcn);
    x = fminbnd(@fun, x1, x2, options);
    
fminbnd(f, a, b, options, P1, P2, ..., Pn) позволяет задать значения дополнительных параметров целевой функции. Например, если целевая функция задана так:
 
function y = myfun(x, a, b, c)

y = a*x^6 + b*x^4 + c*x;

то вызвать метод fminbnd можно командой:

fminbnd(@myfun, −2, 2, 1, 7, −2)

Всякий раз, когда алгоритму будет необходимо вычислить значение целевой функции, параметры a, b, c примут соответственно значения 1, 7, −2. 


### Многомерная оптимизация

Решает задачу поиска локального минимума целевой функции f(x), зависящей от векторного аргумента x:

Используется функция fminsearch аналогичная fminbnd.

Функцию fminsearch можно вызывать с разным количеством входных и выходных аргументов:

* x = fminsearch(fun, x0)
* x = fminsearch(fun, x0, options)
* x = fminsearch(fun, x0, options, P1, P2, ..., Pn)
* [x, fval] = fminsearch(...) [x, fval, exitﬂag] = fminsearch(...)
* [x, fval, exitﬂag, output] = fminsearch(...)

Эти способы, по-существу, повторяют соответсвующие способы вызова функции fminbnd. Единственное отличие заключается в том, что они имеют другие возможные значения флага exitﬂag.




