# Оптимизация

> Оптимизация — в математике, информатике и исследовании операций задача нахождения экстремума (минимума или максимума) целевой функции в некоторой области конечномерного векторного пространства, ограниченной набором линейных и/или нелинейных равенств и/или неравенств.

Теорию и методы решения задачи оптимизации изучает математическое программирование.

## Классификация

**Одномерная оптимизация** - целевая функция - это функция одной переменной.
**Многомерная оптимизация** - целевая функция - функция нескольких переменных.

**Безусловная оптимизация** - область, в которой происходит поиск решения задачи оптимизации, ничем не ограничена.
**Условная оптимизация** - область, в которой происходит поиск решения задачи оптимизации, ограничен набором линейных и/или нелинейных равенств и/или неравенств.

## Безусловная оптимизация в MATLAB

Для решения задачи безусловной оптимизации в MATLAB встроены функции `fminsearch` и `fminunc`.

Функция `fminsearch` реализует __симплексный алгоритм Нелдара-Мида__. Его идея заключается в следующем: на предварительном шаге выбирается `n + 1` точек, не расположенных в одной гиперплоскости. Эти точки являются вершинами симплекса, откуда название алгоритма. Точка, в которой значение функции максимально, удаляется и вместо неё по определённым правилам выбирается другая. Итерации продолжаются до тех пор, пока симплекс не станет достаточно малым. Алгоритм Нелдера-Мида можно использовать для оптимизации негладких и даже разрывных функций.

Функция `fminunc` реализует несколько методов гладкой безусловной оптимизации:

* метод наискорейшего спуска (Steepest Descent method)
* квази-Ньютоновский BFGS-метод (Broyden–Fletcher–Goldfarb–Shanno)
* квази-Ньютоновский DFP-метод (Davidon–Fletcher–Powell)
* методы, основанные на построении доверительных двумерных областей (trust region)

Первые три из них отнесены к «medium-scale»-методам и предназначены для решения задач оптимизации средней размерности (например, не больше 100 переменных), последний — к «large-scale»-методам. По умолчанию, если пользователь задает аналитическое выражение для градиента, запускается метод доверительного интервала. В противном случае используется BFGS-метод, но есть возможность переключиться и на 
другие. Метод наискорейшего спуска, как правило, очень медлителен и его не рекомен-дуется использовать для решения практических задач. В Matlab-е он присутствует только для иллюстративных целей.

### `fminsearch`

```matlab
x = fminsearch(fun,x0)
x = fminsearch(fun,x0,options)
[x,fval] = fminsearch(...)
[x,fval,exitflag] = fminsearch(...)
[x,fval,exitflag,output] = fminsearch(...)
```

Входные параметры:

* `fun` - указатель на функцию. Например, `@function_name`, если функция уже где-то определена, либо `fun = '4*x.^2+3'`, т.е. можно просто задать строку, содержащую запись функции.
* `x0` - стартовая точка.
* `options` - различные дополнительные опции.

Выходные параметры:

* `x` - найденная точка локального минимума.
* `fval` - значение функции в найденной точке.
* `exitflag` - описывает причину, по которой функция завершила свою работу. Возможные значения:
  * `1` - найдено решение `x`.
  * `0` - превышено число итераций `options.MaxIter` или число вычислений функции `MaxFunEvals`.
  * `-1` - алгоритм был остановлен функцией `options.OutputFcn`.
* `output` - структура, содержащая информацию об оптимизации. Поля структуры:
  * `iterations` - число выполненных итераций.
  * `funcCount` - число вычислений значения функции.
  * `algorithm` - название алгоритма: 'Nelder-Mead simplex direct search'.
  * `message` - причина завершения работы функции (в виде текстового сообщения).

#### Пример

```matlab
fun = @myfunc; % '4 * x^2 + 2 * x + 3'; 

[x, y, exitflag, output] = fminsearch(fun, -20);

x, y, exitflag, output

X = -1:0.1:1;
Y = myfunc(X);

hold on;
plot(X, Y, '-r');
plot(x, y, '*b');
hold off;
```

**myfunc.m:**

```matlab
function [Y] = myfunc(X)
Y = 4 * X.^2 + 2 * X + 3;
```

Результат работы:
```
x =

   -0.2500


y =

    2.7500


exitflag =

     1


output = 

    iterations: 22
     funcCount: 44
     algorithm: 'Nelder-Mead simplex direct search'
       message: 'Optimization terminated:
 the current x satisfies the termination criteria using OPTIONS.TolX of 1.000000e-04 
 and...'
```

![Результат безусловной одномерной интерполяции](/7/img1.png)

## Одномерная условная оптимизация в MATLAB

Функция `f(x)` одного аргумента `x` называется унимодальной на отрезке `[a, b]`, если на нём найдется такая точка `x0` (точка минимума), что `f(x)` монотонно убывает при `a ≤ x ≤ x0` и монотонно возрастает при `x0 ≤ x ≤ b`. Для минимизации унимодальной функции, заданной на отрезке Matlab предоставляет функцию `fminbnd`. 

Ее можно применять и для минимизации функций, не являющихся унимодальными. В этом случае будет найден локальный минимум. `fminbnd` использует комбинацию методов золотого сечения и последовательной параболической интерполяции. Реализована функция в виде m-файла, поэтому желающие могут ознакомиться с деталями по исходному коду.

