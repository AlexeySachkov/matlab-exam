# Интерполяция

## Общие сведения

**Интерполяция** - в вычислительной математике способ нахождения промежуточных значений величины по имеющемуся дискретному набору известных значений.

Пусть функция `f(x)` задана таблицей своих значений `xi, yi` на интервале [a, b]:

```
yi = f(xi), i = 0,1,...,n, a <= xi <= b (1)
```

Задача интерполяции - найти функцию `F(x)`, принимающую в точках `xi` те же значения `yi`

Условие интерполяции:

```
F(xi) = yi (2)
```

При этом предполагается, что среди значений `xi` нет одинаковых. Точки `xi` называют узлами интерполяции.

Если `F(x)` ищется только на отрезке `[a, b]` - то это задача интерполяции, а если за пределами первоначального отрезка, то это задача экстраполяции

* Интерполяция – определение промежуточных значений функции по известному дискретному набору значений функции.
* Экстраполяция – определение значений функции за пределами первоначально известного интервала.
* Аппроксимация – определение в явном виде параметров функции, описывающей распределение точек.

Задача нахождения интерполяционной функции `F(x)` имеет много решений, т.к. через данные точки `xi, yi` можно провести бесконечно много кривых, каждая из которых будет графиком функции, для которой выполенены все условия интепрполяции. Для практики важен случай аппроксимации функции многочленами:

```
F(x) = Pm(xi) = a0 + a1 * x + a2 * x^2 + ... + am * x^m, i = 0,1,...,m (3)
```

При этом искомый полином называется интерполяционным полиномом

При построении одного многочлена для всего рассматриваемого интервала `[a, b]`, для нахождения коэффициентов многочлена необходимо использовать все уравнения системы `(3)`. Данная система содержит `n + 1` уравнение, следовательно, с её помощью можно определить `n + 1` коэффициент. Поэтому максимальная степень интерполяционного многочлена `m = n`, и многочлен принимает вид:

```
Pn(xi) = a0 + a1 * x + a2 * x^2 + ... + an * x^n, i = 0,1,...,n (4)
```

### Локальная и глобальная интерполяция

Если задан `n + 1` узел интерполяции, то на этих узлах можно построить один интерполяционный многочлен `n-й` степени, `n - 1` многочленов первой степени и большой набор многочленов степени меньше `n`, опирающиеся на некоторые из этих узлов.

Теоретически максимальную точность обеспечивает многочлен более высокой степени. Однако на практике наиболее часто используют многочлены невысоких степений, во избежание погрешностей при расчётах коэффициентов при больших степенях многочлена.

Если функция `f(x)` интерполируется на отрезке `[a, b]` с помощью единого многочлена `Pm(x)` для всего отрезка, то такую интерполяцию называют глобальной. В случае локальной интерполяции на каждом интервале `[xi, xi+1]` строится отдельный интерполяционный полином невысокой степени

## Методы локальной интерполяции

### Кусочно-линейная интерполяция

Простейшим и часто используемым видом локальной интерполяции является линейная (или кусочно-линейная) интерполяция. Она заключается в том, что узловые точки соединяются отрезками прямых, то есть через каждые две точки `(xi, yi)` и `(xi+1, yi+1)` проводится полином первой степени (рисунок ниже):

```
F(x) = a0 + a1 * x, при xi-1 <= x <= xi (5)
```

Коэффициенты `a0` и `a1` разные на каждом интервале `[xi, xi+1]`, и находятся из выполнения условий интерполяуции на концах отрезка:

```
fi-1 = a0 + a1 * xi-1 (6)
fi = a0 + a1 * xi
```

Из системы уравнений `(6)` можно найти коэффициенты:

```
a0 = f(xi-1) - a1 * xi-1, 
a1 = (f(xi) - f(xi-1)) / (xi - xi-1)
```

При использовании кусочно-линейной интерполяции сначала нужно определить интервал, в который попадает значение x, а затем подставить его в выражение `(5)`, используя коэффициенты для данного интервала

![Кусочно-линейная интерполяция](10/img1.png)

## Источник

* http://aco.ifmo.ru/el_books/numerical_methods/lectures/glava3.html
* https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D1%8F