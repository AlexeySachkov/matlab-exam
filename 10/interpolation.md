# Интерполяция

## Общие сведения

**Интерполяция** - в вычислительной математике способ нахождения промежуточных значений величины по имеющемуся дискретному набору известных значений.

Пусть функция `f(x)` задана таблицей своих значений `xi, yi` на интервале `[a, b]`:

```
yi = f(xi), i = 0,1,...,n, a <= xi <= b (1)
```

Задача интерполяции - найти функцию `F(x)`, принимающую в точках `xi` те же значения `yi`

Условие интерполяции:

```
F(xi) = yi (2)
```

При этом предполагается, что среди значений `xi` нет одинаковых. Точки `xi` называют узлами интерполяции.

Если `F(x)` ищется только на отрезке `[a, b]` - то это задача интерполяции, а если за пределами первоначального отрезка, то это задача экстраполяции

* __Интерполяция__ – определение промежуточных значений функции по известному дискретному набору значений функции.
* __Экстраполяция__ – определение значений функции за пределами первоначально известного интервала.
* __Аппроксимация__ – определение в явном виде параметров функции, описывающей распределение точек.

Задача нахождения интерполяционной функции `F(x)` имеет много решений, т.к. через данные точки `xi`, `yi` можно провести бесконечно много кривых, каждая из которых будет графиком функции, для которой выполенены все условия интепрполяции. Для практики важен случай аппроксимации функции многочленами:

```
F(x) = Pm(xi) = a0 + a1 * x + a2 * x^2 + ... + am * x^m, i = 0,1,...,m (3)
```

При этом искомый полином называется интерполяционным полиномом

При построении одного многочлена для всего рассматриваемого интервала `[a, b]`, для нахождения коэффициентов многочлена необходимо использовать все уравнения системы `(3)`. Данная система содержит `n + 1` уравнение, следовательно, с её помощью можно определить `n + 1` коэффициент. Поэтому максимальная степень интерполяционного многочлена `m = n`, и многочлен принимает вид:

```
Pn(xi) = a0 + a1 * x + a2 * x^2 + ... + an * x^n, i = 0,1,...,n (4)
```

### Локальная и глобальная интерполяция

Если задан `n + 1` узел интерполяции, то на этих узлах можно построить один интерполяционный многочлен `n-й` степени, `n - 1` многочленов первой степени и большой набор многочленов степени меньше `n`, опирающиеся на некоторые из этих узлов.

Теоретически максимальную точность обеспечивает многочлен более высокой степени. Однако на практике наиболее часто используют многочлены невысоких степений, во избежание погрешностей при расчётах коэффициентов при больших степенях многочлена.

Если функция `f(x)` интерполируется на отрезке `[a, b]` с помощью единого многочлена `Pm(x)` для всего отрезка, то такую интерполяцию называют глобальной. В случае локальной интерполяции на каждом интервале `[xi, xi+1]` строится отдельный интерполяционный полином невысокой степени

## Методы локальной интерполяции

### Кусочно-линейная интерполяция

Простейшим и часто используемым видом локальной интерполяции является линейная (или кусочно-линейная) интерполяция. Она заключается в том, что узловые точки соединяются отрезками прямых, то есть через каждые две точки `(xi, yi)` и `(xi+1, yi+1)` проводится полином первой степени (рисунок ниже):

```
F(x) = a0 + a1 * x, при xi-1 <= x <= xi (5)
```

Коэффициенты `a0` и `a1` разные на каждом интервале `[xi, xi+1]`, и находятся из выполнения условий интерполяуции на концах отрезка:

```
fi-1 = a0 + a1 * xi-1 (6)
fi = a0 + a1 * xi
```

Из системы уравнений `(6)` можно найти коэффициенты:

```
a0 = f(xi-1) - a1 * xi-1, (7)
a1 = (f(xi) - f(xi-1)) / (xi - xi-1)
```

При использовании кусочно-линейной интерполяции сначала нужно определить интервал, в который попадает значение `x`, а затем подставить его в выражение `(5)`, используя коэффициенты для данного интервала

![Кусочно-линейная интерполяция](/10/img1.png)

### Кусочно-квадратичная интерполяция

В случае квадратичной интерполяции, для каждых трёх узловых точек `(xi-1, yi-1)`, `(xi, yi)`, `(xi+1, yi+1)`, строится уравнение параболы (рисунок ниже):

```
F(x) = a0 + a1 * x + a2 * x^2, при xi-1 <= x <= xi+1 (8)
```

Здесь коэффициенты `a0`, `a1` и `a2` разные на каждом интервале `[xi-1, xi+1]` и определяются решением системы уравнений для условия прохождения параболы через три точки:

```
fi-1 = a0 + a1 * xi-1 + a2 * xx-i^2 (9)
fi = a0 + a1 * xi + a2 * xx^2
fi+1 = a0 + a1 * xi+1 + a2 * xx+i^2
```

Из системы уравнений `(9)` можно найти коэффициенты:

```
a0 = f(x-i) - a1 * xi-1 - a2 * xi-1^2 (10)
a1 = (f(xi) - f(xi-1))/(xi - xi-1) - a2 * (xi + xi-1)
a2 = (f(xi+1) - f(xi-1))/((xi+1 - xi-1) * (xi+1 - xi)) - (f(xi) - f(xi-1))/((xi - xi-1) * (xi+1 - xi))
```

![Кусочно-квадратичная интерполяция](/10/img2.png)

## Глобальная интепроляция

### Многочлен Лагранжа

При глобальной интреполяции на всём интервале `[a, b]` строится единый многочлен. Одной из форм записи интерполяционного многочлена для глобальной интерполяции является многочлен Лагранжа:

```
Ln(x) = sum(yi * li(x)), i = 0,1,...,n (11)
```

Где `li(x)` - базисные многочлены степени `n`:

```
li(x) = prod((x-xj)/(xi-xj)), j=1,...,n, j != i (12)
```

То есть многочлен Лагранжа:

```
Ln(x) = sum(yi * prod((x-xj)/(xi-xj))), i=0,1,...,n, j=1,...,n, j != i (13)
```

Многочлен `li(x)` удовлетворяет условию `li(xj) = 1, если i = j; li(xj) = 0, если i != j`. Это условие означает, что многочлен равен нулю при каждом `xj`, кроме `xi`, то есть `x0`, `x1`, ..., `xi-1`, `xi+1`, ..., `xn` - корни этого многочлена. Таким образом, степень многочлена `Ln(x)` равна `n` и при `x != xi` в сумме обращаются в ноль все слагаемые, кроме слагаемого с номером `i = j`, равного `yi`.

Выражение `(11)` применимо как для равноотстоящих, так и для не равноотстоящих узлов. Погрешность интерполяции методом Лагранжа зависит от свойств функции `f(x)`, от расположения узлов интерполяции и точки `x`. Полином Лагранжа имеет малую погрешность при небольших значениях `n` (`n < 20`). При больших `n` погрешность начинает расти, что свидетельствует о том, что метод Лагранжа не сходится (т.е. его погрешность не убывает с ростом `n`).

Многочлен Лагранжа в явном виде содержит значения функций в узлах интерполяции, поэтому он удобен, когда значения функций меняются, а узлы интерполяции неизменны. Число арифметических операции, необходимых для построения многочлена Лагранжа, пропорционально `n^2` и является наименьшим для всех форм записи. К недостаткам этой формы записи можно отнести то, что с изменением числа узлов приходится все вычисление проводить заново.

Кусочно-линейная и кусочно-квадратичная локальные интерполяции являются частными случаями интерполяции многочленом Лагранжа.

### Многочлен Ньютона

Пусть функция `f(x)` задана с произвольным шагом и точки таблицы значений занумерованы в произвольном порядке.

Разделённые разности нулевого порядка совпадают со значениями функции в узлах. Разделённые разности первого порядка определяются через разделённые разности нулевого порядка:

```
f(xi, xi+1) = (f(xi+1) - f(xi)) / (xi+1 - xi) (14)
```

Разделённые разности второго порядка определяются через разделённые разности первого порядка:

```
f(xi, xi+1, xi+2) = (f(xi+1, xi+2) - f(xi, xi+1)) / (xi+2 - xi) (15)
```

Разделённые разности `k-го` порядка определяются через разделённую разность порядка `k - 1`:

```
f(xi, xi+1, ..., xi+k) = (f(xi+1, ..., xi+k) - f(xi, ..., xi+k-1)) / (xi+k - xi) (16)
```

Используя понятие разделённой разности интерполяционный многочлен Ньютона можно записать в следующем виде:

```
Pn(x) = f(x0) + f(x0, x1) * (x - x0) + f(x0, x1, x2) * (x - x0) * (x - x1) + ... + f(x0, x1, ..., xn) * (x - x0) * (x - x1) * ... * (x - xn-1) (17)
```

За точностью расчёта можно следить по убыванию членов суммы `(17)`. Если функция достаточно гладкая, то справедливо приближённое равенство `f(x) - Pn(x) ~= Pn+1(x) - Pn(x)`. Это приближённое равенство можно использовать для практической оценки погрешности интерполяции: `En = |Pn+1(x) - Pn(x)|`.

Для повышения точности интерполяции в сумму могут быть добавлены новые члены, что требует подключения дополнительных узлов. При этом для формулы Ньютона безразлично, в каком порядке подключаются новые узлы, в то время как для формулы Лагранжа при добавлении новых узлов все расчёты надо производить заново.

Предположим, что необходимо увеличить степень многочлена на единицу, добавив в таблицу ещё один узел `xn+1`. Для вычисления `Pn+1(x)` Достаточно добавить к `Pn(x)` лишь одно слагаемое `f(x0, ..., xn, xn+1) * (x - x0) * (x - x1) * ... * (x - xn)`

## Источник

* http://aco.ifmo.ru/el_books/numerical_methods/lectures/glava3.html
* https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D1%8F