# Метод наименьших квадратов
Поставим задачу приблизить данные, которые заданы массивами x и y:
```matlab
x = [0.1 0.3 0.45 0.5 0.79 1.1 1.89 2.4 2.45];
y = [-3 -1 0.9 2.4 2.5 1.9 0.1 -1.3 -2.6];
```
Для построения полиномов в matlab используется функция polyfit (x,y,n);
n - степень полинома.
```matlab
p1 = polyfit(x, y, 1)
p3 = polyfit(x, y, 3)
p5 = polyfit(x, y, 5)

xx = linspace(x(1), x(end), 100);
```
linspace - функция создания равномерно расположенных точек на интервале от ( x(1) до x(end) ). Вектор хх понадобится, для построения полиномов.

Значение полиномов вычислим с помощью функции polyval (p,interval)
```matlab
yy1 = polyval(p1, xx);
yy3 = polyval(p3, xx);
yy5 = polyval(p5, xx);
```
Для построения используем plot() : 
```matlab
plot(x, y, 'o', xx, yy1, xx, yy3, xx, yy5);
```
- Метод наименьших квадратов без встроенных функций Matlab
```matlab
% параметры
a = 1.414;
b = 1/sqrt(pi);
c = 0.707;
 
% рассчитываем точки ф-ции
x = -5:5;
y = a*exp(b*x)+c;
 
% делаем метод наименьших квадратов
N = length(x);
Mx  = sum(x);
Mx2 = sum(x.^2);
My  = sum(y);
Mxy = sum(x.*y);
 
A = [Mx2 Mx
     Mx  N];
B = [Mxy; My];
X=A\B;
 
% коэф-ты прямой
ax = X(1)  
bx = X(2)
 
% рассчитываем результирующую прямую
x2 = linspace(min(x),max(x),200);
y2= ax.*x2 + bx;
plot(x,y,'-or',x2,y2,'b'); 
grid on;
legend('Исходная функция','метод наименьших квадратов');
```

# Теория
Задача заключается в нахождении коэффициентов линейной зависимости, при которых функция двух переменных а и b формула принимает наименьшее значение. То есть, при данных а и b сумма квадратов отклонений экспериментальных данных от найденной прямой будет наименьшей. В этом вся суть метода наименьших квадратов.

Таким образом, решение примера сводится к нахождению экстремума функции двух переменных.
